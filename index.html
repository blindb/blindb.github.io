<!DOCTYPE html>
<html lang="en" class="no-js">
    <head><title></title>
        <link href="favicon.ico" rel="icon" type="image/x-icon" />
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
        <style>
            #mapid { height: 900px; }
        </style>
    </head>
    <body class="grid">
		<div id="result"></div>
        <div id="r2"></div>
        <div id="mapid" style="width: 450px; height: 900px;"></div>
	</body>
	<script src="jquery.min.js"></script>
	<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
<!-- https://unpkg.com/leaflet@1.7.1/dist/leaflet.js 
https://unpkg.com/leaflet@1.7.1/dist/leaflet.css
-->
	<script>

    mymap = NaN;
    mymarker= NaN;

    function getResolution() {
        document.getElementById("r2").innerHTML = "resolution: " + screen.width + "x" + screen.height;
    }

    function onMapClick(e) {
        mymarker.setLatLng(e.latlng);
        //mymap.setView(mymarker.getLatLng(),mymap.getZoom());
    }
    function onLocationfound(e) {
        console.log(e);
        mymarker.setLatLng([e.coords.latitude, e.coords.longitude]);
        mymap.setView(mymarker.getLatLng(),mymap.getZoom());
 
    }
    function gcp() {
        //console.log('pla');
        navigator.geolocation.getCurrentPosition(function(e) {
            var positionInfo = "position (" + "Latitude: " + e.coords.latitude + ", " + "Longitude: " + e.coords.longitude + ")";
            document.getElementById("result").innerHTML = positionInfo;
            mymarker.setLatLng([e.coords.latitude, e.coords.longitude]);
            mymap.setView(mymarker.getLatLng(),mymap.getZoom());
            setTimeout(function(){ gcp(), 1000});
        });
        
    }
	
	$( document ).ready(function() {
        getResolution();
		if(navigator.geolocation) {
            
            
            navigator.geolocation.getCurrentPosition(function(position) {
                console.log('x');
				pla = position.coords.latitude;
				plo = position.coords.longitude;

				mymap = L.map('mapid').setView([pla, plo], 16);
                mymap.on('click', onMapClick);
                //mymap.on('locationfound', onLocationfound);
/*
				var svgElement = document.createElementNS("http://www.w3.org/2000/svg", "svg");
				svgElement.setAttribute('xmlns', "http://www.w3.org/2000/svg");
				svgElement.setAttribute('viewBox', "pla 0 200 200");
				svgElement.innerHTML = '<rect width="200" height="200"/><rect x="75" y="23" width="50" height="50" style="fill:red"/><rect x="75" y="123" width="50" height="50" style="fill:#0013ff"/>';
				var svgElementBounds = [ [ pla, plo ], [ 13, -100 ] ];
				L.svgOverlay(svgElement, svgElementBounds).addTo(mymap);
*/
				var imageUrl = 'images/map1.png',
    			imageBounds = [[pla-0.03, plo-0.02], [pla+0.2, plo+0.2]];
				L.imageOverlay(imageUrl, imageBounds).addTo(mymap);

				console.log(pla);
				mymarker = L.marker([pla, plo]).addTo(mymap);
                gcp();
            });
            //navigator.geolocation.watchPosition(onLocationfound);
        
    }
});
	</script>
</html>