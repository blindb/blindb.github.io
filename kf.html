<!DOCTYPE html>
<html lang="en" class="no-js">
    <head><title></title>
        <link href="favicon.ico" rel="icon" type="image/x-icon" />
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
        <style>
            #mapidx { height: 900px; }
        </style>
    </head>
    <body class="grid">
		<div id="result"></div>
        <div id="r2"></div>
        <div id="mapid" style="width: 390px; height: 700px;"></div>
	</body>
	<script src="jquery.min.js"></script>
	<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
<!-- https://unpkg.com/leaflet@1.7.1/dist/leaflet.js 
https://unpkg.com/leaflet@1.7.1/dist/leaflet.css
-->
	<script>

    mymap = NaN;
    mymarker= NaN;

    function getResolution() {
        document.getElementById("r2").innerHTML = "R: " + screen.width + "x" + screen.height;
    }

    function onMapClick(e) {
        mymarker.setLatLng(e.latlng);
        //mymap.setView(mymarker.getLatLng(),mymap.getZoom());
    }
    
    function onLocationfound(e) {
        //console.log(e);
        doit(e);
    }

    function doit(e) {
            var positionInfo = "position (" + "Latitude: " + e.coords.latitude + ", " + "Longitude: " + e.coords.longitude + "), zoom:" + mymap.getZoom();
            document.getElementById("result").innerHTML = positionInfo;
            mymarker.setLatLng([e.coords.latitude, e.coords.longitude]);
    }
    
    function gcp() {
        //console.log('pla');
        navigator.geolocation.getCurrentPosition(function(e) {
            doit(e);
            //var positionInfo = "position (" + "Latitude: " + e.coords.latitude + ", " + "Longitude: " + e.coords.longitude + "), zoom:" + mymap.getZoom();
            //document.getElementById("result").innerHTML = positionInfo;
            //mymarker.setLatLng([e.coords.latitude, e.coords.longitude]);
            //mymap.setView(mymarker.getLatLng(),mymap.getZoom());
            //setTimeout(new function(){ gcp();}, 1000);
        });
        
    }
	
	$( document ).ready(function() {
        getResolution();
		if(navigator.geolocation) {
                        
            navigator.geolocation.getCurrentPosition(function(position) {

				pla = position.coords.latitude;
				plo = position.coords.longitude;

				mymap = L.map('mapid').setView([pla, plo], 19);
                //mymap.on('click', onMapClick);
                //mymap.on('locationfound', onLocationfound);

                var scale = 0.001;
				var imageUrl = 'images/spline.svg',
    			imageBounds = [[pla-scale, plo-scale], [pla+scale, plo+scale]];
				L.imageOverlay(imageUrl, imageBounds).addTo(mymap);

				//console.log(pla);
				mymarker = L.marker([pla, plo]).addTo(mymap);
                gcp();
            });
            navigator.geolocation.watchPosition(onLocationfound);
        
    }
});
	</script>
</html>